-- Astral Projection & Player Mimic Script
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local HttpService = game:GetService("HttpService")

-- Create GUI
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "AstralProjectionGUI"
screenGui.ResetOnSpawn = false

-- Main frame
local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0, 350, 0, 450)
mainFrame.Position = UDim2.new(0, 100, 0, 100)
mainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
mainFrame.BorderSizePixel = 0
mainFrame.Active = true
mainFrame.Draggable = true
mainFrame.Parent = screenGui

local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(0, 8)
corner.Parent = mainFrame

-- Title bar
local titleBar = Instance.new("Frame")
titleBar.Size = UDim2.new(1, 0, 0, 40)
titleBar.Position = UDim2.new(0, 0, 0, 0)
titleBar.BackgroundColor3 = Color3.fromRGB(20, 20, 30)
titleBar.BorderSizePixel = 0
titleBar.Parent = mainFrame

local titleCorner = Instance.new("UICorner")
titleCorner.CornerRadius = UDim.new(0, 8)
titleCorner.Parent = titleBar

local title = Instance.new("TextLabel")
title.Size = UDim2.new(0.7, 0, 1, 0)
title.Position = UDim2.new(0.05, 0, 0, 0)
title.BackgroundTransparency = 1
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.Text = "üåå Astral Projection"
title.Font = Enum.Font.GothamBold
title.TextSize = 16
title.TextXAlignment = Enum.TextXAlignment.Left
title.Parent = titleBar

-- Minimize button
local minimizeButton = Instance.new("TextButton")
minimizeButton.Size = UDim2.new(0, 25, 0, 25)
minimizeButton.Position = UDim2.new(0.85, 0, 0.2, 0)
minimizeButton.BackgroundColor3 = Color3.fromRGB(60, 60, 80)
minimizeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
minimizeButton.Text = "-"
minimizeButton.Font = Enum.Font.GothamBold
minimizeButton.TextSize = 16
minimizeButton.Parent = titleBar

local minCorner = Instance.new("UICorner")
minCorner.CornerRadius = UDim.new(0, 4)
minCorner.Parent = minimizeButton

-- Content frame
local contentFrame = Instance.new("Frame")
contentFrame.Size = UDim2.new(1, 0, 1, -40)
contentFrame.Position = UDim2.new(0, 0, 0, 40)
contentFrame.BackgroundTransparency = 1
contentFrame.Parent = mainFrame

-- Astral Projection Section
local astralLabel = Instance.new("TextLabel")
astralLabel.Size = UDim2.new(0.9, 0, 0, 25)
astralLabel.Position = UDim2.new(0.05, 0, 0.02, 0)
astralLabel.BackgroundTransparency = 1
astralLabel.TextColor3 = Color3.fromRGB(100, 200, 255)
astralLabel.Text = "ASTRAL PROJECTION:"
astralLabel.Font = Enum.Font.GothamBold
astralLabel.TextSize = 14
astralLabel.TextXAlignment = Enum.TextXAlignment.Left
astralLabel.Parent = contentFrame

local projectButton = Instance.new("TextButton")
projectButton.Size = UDim2.new(0.9, 0, 0, 45)
projectButton.Position = UDim2.new(0.05, 0, 0.08, 0)
projectButton.BackgroundColor3 = Color3.fromRGB(80, 160, 255)
projectButton.TextColor3 = Color3.fromRGB(255, 255, 255)
projectButton.Text = "üöÄ PROJECT ASTRAL BODY"
projectButton.Font = Enum.Font.GothamBold
projectButton.TextSize = 14
projectButton.Parent = contentFrame

local projectCorner = Instance.new("UICorner")
projectCorner.CornerRadius = UDim.new(0, 6)
projectCorner.Parent = projectButton

local unprojectButton = Instance.new("TextButton")
unprojectButton.Size = UDim2.new(0.9, 0, 0, 35)
unprojectButton.Position = UDim2.new(0.05, 0, 0.18, 0)
unprojectButton.BackgroundColor3 = Color3.fromRGB(255, 100, 100)
unprojectButton.TextColor3 = Color3.fromRGB(255, 255, 255)
unprojectButton.Text = "üîô RETURN TO BODY"
unprojectButton.Font = Enum.Font.GothamBold
unprojectButton.TextSize = 12
unprojectButton.Parent = contentFrame

local unprojectCorner = Instance.new("UICorner")
unprojectCorner.CornerRadius = UDim.new(0, 6)
unprojectCorner.Parent = unprojectButton

-- Player Mimic Section
local mimicLabel = Instance.new("TextLabel")
mimicLabel.Size = UDim2.new(0.9, 0, 0, 25)
mimicLabel.Position = UDim2.new(0.05, 0, 0.3, 0)
mimicLabel.BackgroundTransparency = 1
mimicLabel.TextColor3 = Color3.fromRGB(255, 200, 100)
mimicLabel.Text = "PLAYER MIMICRY:"
mimicLabel.Font = Enum.Font.GothamBold
mimicLabel.TextSize = 14
mimicLabel.TextXAlignment = Enum.TextXAlignment.Left
mimicLabel.Parent = contentFrame

-- Dropdown container
local dropdownContainer = Instance.new("Frame")
dropdownContainer.Size = UDim2.new(0.9, 0, 0, 35)
dropdownContainer.Position = UDim2.new(0.05, 0, 0.37, 0)
dropdownContainer.BackgroundTransparency = 1
dropdownContainer.Parent = contentFrame

local playerDropdown = Instance.new("Frame")
playerDropdown.Size = UDim2.new(1, 0, 0, 35)
playerDropdown.BackgroundColor3 = Color3.fromRGB(50, 50, 65)
playerDropdown.BorderSizePixel = 0
playerDropdown.Parent = dropdownContainer

local dropCorner = Instance.new("UICorner")
dropCorner.CornerRadius = UDim.new(0, 6)
dropCorner.Parent = playerDropdown

local dropdownButton = Instance.new("TextButton")
dropdownButton.Size = UDim2.new(1, 0, 1, 0)
dropdownButton.BackgroundTransparency = 1
dropdownButton.Text = "üë§ Select Player to Mimic"
dropdownButton.TextColor3 = Color3.fromRGB(255, 255, 255)
dropdownButton.Font = Enum.Font.Gotham
dropdownButton.TextSize = 12
dropdownButton.Parent = playerDropdown

local dropdownFrame = Instance.new("ScrollingFrame")
dropdownFrame.Size = UDim2.new(1, 0, 0, 120)
dropdownFrame.Position = UDim2.new(0, 0, 0, -125)
dropdownFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 55)
dropdownFrame.BorderSizePixel = 0
dropdownFrame.Visible = false
dropdownFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
dropdownFrame.ScrollBarThickness = 4
dropdownFrame.AutomaticCanvasSize = Enum.AutomaticSize.Y
dropdownFrame.Parent = dropdownContainer

local dropFrameCorner = Instance.new("UICorner")
dropFrameCorner.CornerRadius = UDim.new(0, 6)
dropFrameCorner.Parent = dropdownFrame

local UIListLayout = Instance.new("UIListLayout")
UIListLayout.Padding = UDim.new(0, 2)
UIListLayout.Parent = dropdownFrame

local mimicButton = Instance.new("TextButton")
mimicButton.Size = UDim2.new(0.9, 0, 0, 45)
mimicButton.Position = UDim2.new(0.05, 0, 0.52, 0)
mimicButton.BackgroundColor3 = Color3.fromRGB(255, 170, 80)
mimicButton.TextColor3 = Color3.fromRGB(255, 255, 255)
mimicButton.Text = "üé≠ MIMIC SELECTED PLAYER"
mimicButton.Font = Enum.Font.GothamBold
mimicButton.TextSize = 14
mimicButton.Parent = contentFrame

local mimicCorner = Instance.new("UICorner")
mimicCorner.CornerRadius = UDim.new(0, 6)
mimicCorner.Parent = mimicButton

local unmimicButton = Instance.new("TextButton")
unmimicButton.Size = UDim2.new(0.9, 0, 0, 35)
unmimicButton.Position = UDim2.new(0.05, 0, 0.62, 0)
unmimicButton.BackgroundColor3 = Color3.fromRGB(100, 100, 120)
unmimicButton.TextColor3 = Color3.fromRGB(255, 255, 255)
unmimicButton.Text = "üë§ RETURN TO SELF"
unmimicButton.Font = Enum.Font.GothamBold
unmimicButton.TextSize = 12
unmimicButton.Parent = contentFrame

local unmimicCorner = Instance.new("UICorner")
unmimicCorner.CornerRadius = UDim.new(0, 6)
unmimicCorner.Parent = unmimicButton

-- Status label
local statusLabel = Instance.new("TextLabel")
statusLabel.Size = UDim2.new(0.9, 0, 0, 80)
statusLabel.Position = UDim2.new(0.05, 0, 0.75, 0)
statusLabel.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
statusLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
statusLabel.Text = "Status: Ready\nSelect an option above"
statusLabel.Font = Enum.Font.Gotham
statusLabel.TextSize = 12
statusLabel.TextWrapped = true
statusLabel.Parent = contentFrame

local statusCorner = Instance.new("UICorner")
statusCorner.CornerRadius = UDim.new(0, 6)
statusCorner.Parent = statusLabel

-- Close button
local closeButton = Instance.new("TextButton")
closeButton.Size = UDim2.new(0.9, 0, 0, 35)
closeButton.Position = UDim2.new(0.05, 0, 0.92, 0)
closeButton.BackgroundColor3 = Color3.fromRGB(120, 40, 40)
closeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
closeButton.Text = "‚ùå CLOSE GUI"
closeButton.Font = Enum.Font.Gotham
closeButton.TextSize = 12
closeButton.Parent = contentFrame

local closeCorner = Instance.new("UICorner")
closeCorner.CornerRadius = UDim.new(0, 6)
closeCorner.Parent = closeButton

-- Insert GUI
screenGui.Parent = game:GetService("CoreGui") or game.Players.LocalPlayer:WaitForChild("PlayerGui")

-- Variables
local localPlayer = game.Players.LocalPlayer
local selectedPlayer = nil
local isMinimized = false

-- Astral Projection Variables
local isAstral = false
local originalBody = nil
local astralBody = nil
local skeletonAdornment = nil

-- Player Mimic Variables
local isMimicking = false
local originalName = localPlayer.Name
local originalDisplayName = localPlayer.DisplayName

-- Function to create skeleton overlay
local function createSkeletonOverlay(character)
    if not character then return nil end
    
    local skeleton = Instance.new("Model")
    skeleton.Name = "AstralSkeleton"
    
    for _, part in ipairs(character:GetChildren()) do
        if part:IsA("BasePart") then
            local skeletonPart = Instance.new("Part")
            skeletonPart.Name = part.Name
            skeletonPart.Size = part.Size
            skeletonPart.CFrame = part.CFrame
            skeletonPart.Anchored = true
            skeletonPart.CanCollide = false
            skeletonPart.Material = Enum.Material.Neon
            skeletonPart.BrickColor = BrickColor.new("Cyan")
            skeletonPart.Transparency = 0.3
            skeletonPart.Parent = skeleton
            
            -- Add wireframe effect
            local surfaceGui = Instance.new("SurfaceGui")
            surfaceGui.Face = Enum.NormalId.Front
            surfaceGui.AlwaysOnTop = true
            surfaceGui.Parent = skeletonPart
            
            local frame = Instance.new("Frame")
            frame.Size = UDim2.new(1, 0, 1, 0)
            frame.BackgroundColor3 = Color3.fromRGB(0, 255, 255)
            frame.BackgroundTransparency = 0.7
            frame.BorderSizePixel = 0
            frame.Parent = surfaceGui
        end
    end
    
    return skeleton
end

-- Function to project astral body
local function projectAstralBody()
    if isAstral then return false end
    
    local character = localPlayer.Character
    if not character then
        statusLabel.Text = "‚ùå No character found"
        return false
    end
    
    local humanoid = character:FindFirstChildOfClass("Humanoid")
    local rootPart = character:FindFirstChild("HumanoidRootPart")
    
    if not humanoid or not rootPart then
        statusLabel.Text = "‚ùå Character not fully loaded"
        return false
    end
    
    -- Store original body
    originalBody = character
    
    -- Create astral body (invisible copy)
    local astral = character:Clone()
    astral.Name = "AstralProjection"
    
    -- Make astral body invisible to others but visible to self
    for _, part in ipairs(astral:GetChildren()) do
        if part:IsA("BasePart") then
            part.Transparency = 1  -- Invisible to others
            part.CanCollide = false
        end
    end
    
    -- Position astral body at current location
    astral:PivotTo(rootPart.CFrame)
    astral.Parent = workspace
    
    -- Create skeleton overlay for client visibility
    skeletonAdornment = createSkeletonOverlay(astral)
    if skeletonAdornment then
        skeletonAdornment.Parent = astral
    end
    
    -- Make original body appear AFK (disable movements)
    humanoid.WalkSpeed = 0
    humanoid.JumpPower = 0
    
    -- Set up astral body as the active character
    localPlayer.Character = astral
    isAstral = true
    astralBody = astral
    
    -- Force camera to follow astral body
    workspace.CurrentCamera.CameraSubject = astral:FindFirstChildOfClass("Humanoid")
    
    statusLabel.Text = "‚úÖ Astral projection active!\n‚Ä¢ Your body appears AFK to others\n‚Ä¢ You can move freely in astral form\n‚Ä¢ Skeleton visible only to you\n‚Ä¢ You can be hit in astral form"
    
    return true
end

-- Function to return to original body
local function returnToBody()
    if not isAstral or not originalBody then return false end
    
    -- Return to original body
    localPlayer.Character = originalBody
    
    -- Restore original body movements
    local humanoid = originalBody:FindFirstChildOfClass("Humanoid")
    if humanoid then
        humanoid.WalkSpeed = 16
        humanoid.JumpPower = 50
    end
    
    -- Clean up astral body
    if astralBody then
        astralBody:Destroy()
        astralBody = nil
    end
    
    if skeletonAdornment then
        skeletonAdornment:Destroy()
        skeletonAdornment = nil
    end
    
    isAstral = false
    originalBody = nil
    
    statusLabel.Text = "‚úÖ Returned to original body!\nAll functions restored to normal"
    
    return true
end

-- Function to mimic player
local function mimicPlayer(targetPlayer)
    if not targetPlayer or targetPlayer == localPlayer then
        statusLabel.Text = "‚ùå Cannot mimic yourself or invalid player"
        return false
    end
    
    -- Store original identity
    if not isMimicking then
        originalName = localPlayer.Name
        originalDisplayName = localPlayer.DisplayName
    end
    
    -- Change player name (this is client-side only due to Roblox restrictions)
    localPlayer.DisplayName = targetPlayer.DisplayName
    
    -- Change character appearance as much as possible
    local targetChar = targetPlayer.Character
    local localChar = localPlayer.Character
    
    if targetChar and localChar then
        -- Copy body colors
        local targetHumanoid = targetChar:FindFirstChildOfClass("Humanoid")
        local localHumanoid = localChar:FindFirstChildOfClass("Humanoid")
        
        if targetHumanoid and localHumanoid then
            -- Copy body colors
            if targetHumanoid:FindFirstChild("BodyColors") then
                local targetColors = targetHumanoid.BodyColors
                local newColors = targetColors:Clone()
                
                if localHumanoid:FindFirstChild("BodyColors") then
                    localHumanoid.BodyColors:Destroy()
                end
                newColors.Parent = localHumanoid
            end
            
            -- Copy scale if available
            if targetHumanoid:FindFirstChild("BodyHeightScale") then
                local scale = targetHumanoid.BodyHeightScale:Clone()
                if localHumanoid:FindFirstChild("BodyHeightScale") then
                    localHumanoid.BodyHeightScale:Destroy()
                end
                scale.Parent = localHumanoid
            end
        end
        
        -- Copy accessories and clothing
        for _, item in ipairs(localChar:GetChildren()) do
            if item:IsA("Accoutrement") or item:IsA("Clothing") then
                item:Destroy()
            end
        end
        
        for _, item in ipairs(targetChar:GetChildren()) do
            if item:IsA("Accoutrement") or item:IsA("Clothing") then
                local clone = item:Clone()
                clone.Parent = localChar
            end
        end
    end
    
    isMimicking = true
    
    statusLabel.Text = "‚úÖ Now mimicking: " .. targetPlayer.Name .. "\n‚Ä¢ Display name changed\n‚Ä¢ Appearance copied\n‚Ä¢ Others see you as " .. targetPlayer.DisplayName
    
    return true
end

-- Function to stop mimicking
local function stopMimicking()
    if not isMimicking then return false end
    
    -- Restore original identity
    localPlayer.DisplayName = originalDisplayName
    
    -- Reset character appearance
    local character = localPlayer.Character
    if character then
        local humanoid = character:FindFirstChildOfClass("Humanoid")
        if humanoid then
            -- Trigger respawn to reset appearance completely
            humanoid.Health = 0
        end
    end
    
    isMimicking = false
    
    statusLabel.Text = "‚úÖ Stopped mimicking!\nReturned to your original identity"
    
    return true
end

-- Function to update players list
local function updatePlayersList()
    for _, child in ipairs(dropdownFrame:GetChildren()) do
        if child:IsA("TextButton") then
            child:Destroy()
        end
    end
    
    for _, player in ipairs(game.Players:GetPlayers()) do
        if player ~= localPlayer then
            local playerButton = Instance.new("TextButton")
            playerButton.Size = UDim2.new(1, 0, 0, 30)
            playerButton.BackgroundColor3 = Color3.fromRGB(60, 60, 80)
            playerButton.BorderSizePixel = 0
            playerButton.Text = "üë§ " .. player.Name
            playerButton.TextColor3 = Color3.fromRGB(255, 255, 255)
            playerButton.Font = Enum.Font.Gotham
            playerButton.TextSize = 12
            playerButton.Parent = dropdownFrame
            
            local btnCorner = Instance.new("UICorner")
            btnCorner.CornerRadius = UDim.new(0, 4)
            btnCorner.Parent = playerButton
            
            playerButton.MouseButton1Click:Connect(function()
                selectedPlayer = player
                dropdownButton.Text = "üë§ " .. player.Name
                dropdownFrame.Visible = false
                statusLabel.Text = "Selected: " .. player.Name .. "\nReady to mimic this player!"
            end)
        end
    end
    
    if #game.Players:GetPlayers() <= 1 then
        dropdownButton.Text = "üë§ No other players"
        selectedPlayer = nil
    end
end

-- Toggle minimize function
local function toggleMinimize()
    if isMinimized then
        contentFrame.Visible = true
        mainFrame.Size = UDim2.new(0, 350, 0, 450)
        minimizeButton.Text = "-"
        isMinimized = false
    else
        contentFrame.Visible = false
        mainFrame.Size = UDim2.new(0, 350, 0, 40)
        minimizeButton.Text = "+"
        isMinimized = true
    end
end

-- Connect events
projectButton.MouseButton1Click:Connect(function()
    if projectAstralBody() then
        projectButton.BackgroundColor3 = Color3.fromRGB(60, 140, 220)
        unprojectButton.BackgroundColor3 = Color3.fromRGB(255, 100, 100)
    end
end)

unprojectButton.MouseButton1Click:Connect(function()
    if returnToBody() then
        projectButton.BackgroundColor3 = Color3.fromRGB(80, 160, 255)
        unprojectButton.BackgroundColor3 = Color3.fromRGB(180, 80, 80)
    end
end)

dropdownButton.MouseButton1Click:Connect(function()
    updatePlayersList()
    dropdownFrame.Visible = not dropdownFrame.Visible
end)

mimicButton.MouseButton1Click:Connect(function()
    if selectedPlayer then
        if mimicPlayer(selectedPlayer) then
            mimicButton.BackgroundColor3 = Color3.fromRGB(220, 150, 60)
            unmimicButton.BackgroundColor3 = Color3.fromRGB(100, 100, 120)
        end
    else
        statusLabel.Text = "‚ö†Ô∏è Please select a player first!"
    end
end)

unmimicButton.MouseButton1Click:Connect(function()
    if stopMimicking() then
        mimicButton.BackgroundColor3 = Color3.fromRGB(255, 170, 80)
        unmimicButton.BackgroundColor3 = Color3.fromRGB(80, 80, 100)
    end
end)

minimizeButton.MouseButton1Click:Connect(toggleMinimize)

closeButton.MouseButton1Click:Connect(function()
    -- Clean up before closing
    if isAstral then
        returnToBody()
    end
    if isMimicking then
        stopMimicking()
    end
    screenGui:Destroy()
end)

-- Close dropdown when clicking outside
UserInputService.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        if dropdownFrame.Visible then
            dropdownFrame.Visible = false
        end
    end
end)

-- Auto-refresh players list
game.Players.PlayerAdded:Connect(updatePlayersList)
game.Players.PlayerRemoving:Connect(updatePlayersList)

-- Handle character respawns
localPlayer.CharacterAdded:Connect(function(character)
    if isAstral then
        wait(1) -- Wait for character to load
        returnToBody()
    end
    if isMimicking then
        wait(1)
        -- Re-apply mimic after respawn
        if selectedPlayer then
            mimicPlayer(selectedPlayer)
        end
    end
end)

-- Initial update
updatePlayersList()

statusLabel.Text = "‚úÖ Astral Projection GUI Loaded!\n‚Ä¢ PROJECT: Leave your body behind\n‚Ä¢ MIMIC: Copy another player's identity\n‚Ä¢ Works in most games"

print("üåå Astral Projection GUI loaded successfully!")
print("‚ú® Features:")
print("   ‚Ä¢ Astral Projection: Leave body behind while moving freely")
print("   ‚Ä¢ Player Mimicry: Copy names and appearances")
print("   ‚Ä¢ Skeleton overlay for astral form")
print("   ‚Ä¢ Compatible with most Roblox games")
